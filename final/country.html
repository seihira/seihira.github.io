<html>
<head>
<meta charset="utf-8">
<link rel="stylesheet" type="text/css" href="country.css">
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="googleSheets.js"></script>
  <title>ğŸ³â€ğŸŒˆCapital cityğŸ³â€ğŸŒˆ</title>
</head>
<body>
<style>
.links line {
    stroke: #999;
    stroke-opacity: 5;
}
.nodes circle {
  stroke: #fff;
    stroke-width: 2.5px;
}
.center-box {
    text-align:center;
}
.large-text {
    font-size: 4.0rem;
}

text {
  font-family: sans-serif;
  font-size: 12px;
}
</style>
<svg width="1000" height="600"></svg>

<script src="https://d3js.org/d3.v4.min.js"></script>

      <p id="view" title="name">ï¼ŠğŸ³â€ğŸŒˆä¸Šå›³ã®é¦–éƒ½ã®åå‰ã‚’å–‹ã£ã¦ãã ã•ã„ï¼Š</p>
<script>

let svg = d3.select("svg"),
    width = +svg.attr("width"),
    height = +svg.attr("height");

let color = d3.scaleOrdinal(d3.schemeCategory20);

let simulation = d3.forceSimulation()
  .force("link", d3.forceLink().id(function(d) { return d.id; }))
  // .force("collide",d3.forceCollide().radius(20).iterations(16))
  .force("charge", d3.forceManyBody().strength(-100))  //åç™ºåŠ›ã®è¨­å®š
  .force("center", d3.forceCenter(width / 2, height / 2))
  .force("x", d3.forceX().x(width / 2).strength(0.1))  //xæ–¹å‘ã«æˆ»ã‚‹åŠ›
  .force("y", d3.forceY().y(height / 2).strength(0.1)) //yæ–¹å‘ã«æˆ»ã‚‹åŠ›
  ;

d3.json("country.json", function(error, graph) {
  if (error) throw error;
  let link = svg.append("g")
    .attr("class", "links")
    .selectAll("line")
    .data(graph.links)
    .enter().append("line")
    .attr("stroke-width", function(d) { return Math.sqrt(d.value); });

  let node = svg.append("g")
    .attr("class", "nodes")
    .selectAll("g")
    .data(graph.nodes)
    .enter().append("g")
    
  let circles = node.append("circle")
    .attr("r", 5)
    .attr("fill", function(d) { return color(d.group); })
    .call(d3.drag()
      .on("start", dragstarted)
      .on("drag", dragged)
      .on("end", dragended));

  let lables = node.append("text")
    .text(function(d) {
      return d.id;
    })
    .attr('x', 6)
    .attr('y', 3);

  node.append("title")
    .text(function(d) { return d.id; });

  simulation
    .nodes(graph.nodes)
    .on("tick", ticked);

  simulation.force("link")
    .links(graph.links);

  function ticked() {
    link
    .attr("x1", function(d) { return d.source.x; })
    .attr("y1", function(d) { return d.source.y; })
    .attr("x2", function(d) { return d.target.x; })
    .attr("y2", function(d) { return d.target.y; });

    node
    .attr("transform", function(d) {
      return "translate(" + d.x + "," + d.y + ")";
    })
  }
});

function dragstarted(d) {
  if (!d3.event.active) simulation.alphaTarget(0.3).restart();
  d.fx = d.x;
  d.fy = d.y;
}

function dragged(d) {
  d.fx = d3.event.x;
  d.fy = d3.event.y;
}

function dragended(d) {
  if (!d3.event.active) simulation.alphaTarget(0).force("collide",d3.forceCollide().radius(10).iterations(16));
  d.fx = null;
  d.fy = null;
}

// ãƒã‚¦ã‚¹ãƒ‰ãƒ©ãƒƒã‚°ã‚’ã™ã‚‹éš›ã«ã€ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’ç¦æ­¢ã™ã‚‹ãŸã‚ã®ã‚³ãƒ¼ãƒ‰
function handleTouchMove(event) {
  event.preventDefault();
}
document.addEventListener('touchmove', handleTouchMove, { passive: false });
document.removeEventListener('touchmove', handleTouchMove, { passive: false });

</script>

<p class="center-box"><img id="mic" src="micoff.svg" width=20%></p>
<div id="result-div" class="large-text"></div>

<script>
  const resultDiv = document.querySelector('#result-div');
  const micDiv = document.querySelector('#mic');
  let speakingtime = 0;
  
  // éŸ³å£°èªè­˜æ©Ÿèƒ½(Chrome)
  let rec = new webkitSpeechRecognition();
  let stopped = true;
  rec.continuous = true;
  rec.interimResults = false;
  rec.lang = 'ja-JP';

  micDiv.onclick = function () {
    if (stopped == true) {
      stopped = false;
      resultDiv.innerHTML = "";
      rec.start();
    } else {
      stopped = true;
      rec.stop();
    }
  }

  rec.onstart = function () { 
    console.log('on start');
    micDiv.setAttribute("src","micon.svg");
    speakingtime = 0;
  };

  rec.onend = function () { 
    console.log('on end');
    micDiv.setAttribute("src","micoff.svg");
    if (stopped == false) {
      setTimeout(function () {
        rec.start();
      },speakingtime);
    }
  };

  rec.onresult = function (e) {
    rec.stop();
    for (let i = e.resultIndex; i < e.results.length; i++) {
      if (e.results[i].isFinal) {
        console.log(e);
        let text = e.results[i][0].transcript;
        console.log(text);
        speakingtime = text.length * 200;
        console.log("estimate:", speakingtime, "ms");
        speak(reply(text));
        resultDiv.innerHTML = text;
      }
    }
  }
  
  function reply (text){
      if (text == "æ±äº¬"){
          return "æ±äº¬ã¯æ—¥æœ¬ã®é¦–éƒ½ã§ã™";
      } else if (text == "åŒ—äº¬"){
          return "åŒ—äº¬ã¯ä¸­å›½ã®é¦–éƒ½ã§ã™";
      } else if (text == "ã‚½ã‚¦ãƒ«"){
          return "ã‚½ã‚¦ãƒ«ã¯éŸ“å›½ã®é¦–éƒ½ã§ã™";
      } else if (text == "ã‚¸ãƒ£ã‚«ãƒ«ã‚¿"){
          return "ã‚¸ãƒ£ã‚«ãƒ«ã‚¿ã¯ã‚¤ãƒ³ãƒ‰ãƒã‚·ã‚¢ã®é¦–éƒ½ã§ã™";
      } else if (text == "ãƒ‹ãƒ¥ãƒ¼ãƒ‡ãƒªãƒ¼"){
          return "ãƒ‹ãƒ¥ãƒ¼ãƒ‡ãƒªãƒ¼ã¯ã‚¤ãƒ³ãƒ‰ã®é¦–éƒ½ã§ã™";
      } else if (text == "ã‚·ãƒ³ã‚¬ãƒãƒ¼ãƒ«"){
          return "ã‚·ãƒ³ã‚¬ãƒãƒ¼ãƒ«ã¯ã‚·ãƒ³ã‚¬ãƒãƒ¼ãƒ«ã®é¦–éƒ½ã§ã™";
      } else if (text == "ãƒãƒ³ã‚³ã‚¯"){
          return "ãƒãƒ³ã‚³ã‚¯ã¯ã‚¿ã‚¤ã®é¦–éƒ½ã§ã™";
      } else if (text == "å°åŒ—"){
          return "å°åŒ—ã¯å°æ¹¾ã®é¦–éƒ½ã§ã™";
      } else if (text == "ãƒ­ãƒ³ãƒ‰ãƒ³"){
          return "ãƒ­ãƒ³ãƒ‰ãƒ³ã¯ã‚¤ã‚®ãƒªã‚¹ã®é¦–éƒ½ã§ã™";
      } else if (text == "ãƒ­ãƒ¼ãƒ"){
          return "ãƒ­ãƒ¼ãƒã¯ã‚¤ã‚¿ãƒªã‚¢ã®é¦–éƒ½ã§ã™";
      } else if (text == "ã‚­ã‚¨ãƒ•"){
          return "ã‚­ã‚¨ãƒ•ã¯ã‚¦ã‚¯ãƒ©ã‚¤ãƒŠã®é¦–éƒ½ã§ã™";
      } else if (text == "ã‚¦ã‚£ãƒ¼ãƒ³"){
          return "ã‚¦ã‚£ãƒ¼ãƒ³ã¯ã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢ã®é¦–éƒ½ã§ã™";
      } else if (text == "ã‚¢ãƒ ã‚¹ãƒ†ãƒ«ãƒ€ãƒ "){
          return "ã‚¢ãƒ ã‚¹ãƒ†ãƒ«ãƒ€ãƒ ã¯ã‚ªãƒ©ãƒ³ãƒ€ã®é¦–éƒ½ã§ã™";
      } else if (text == "ã‚¢ãƒ†ãƒ"){
          return "ã‚¢ãƒ†ãƒã¯ã‚®ãƒªã‚·ãƒ£ã®é¦–éƒ½ã§ã™";
      } else if (text == "ãƒ™ãƒ«ãƒ³"){
          return "ãƒ™ãƒ«ãƒ³ã¯ã‚¹ã‚¤ã‚¹ã®é¦–éƒ½ã§ã™";
      } else if (text == "ã‚¹ãƒˆãƒƒã‚¯ãƒ›ãƒ«ãƒ "){
          return "ã‚¹ãƒˆãƒƒã‚¯ãƒ›ãƒ«ãƒ ã¯ã‚¹ã‚¦ã‚§ãƒ¼ãƒ‡ãƒ³ã®é¦–éƒ½ã§ã™";
      } else if (text == "ãƒãƒ‰ãƒªãƒ¼ãƒ‰"){
          return "ãƒãƒ‰ãƒªãƒ¼ãƒ‰ã¯ã‚¹ãƒšã‚¤ãƒ³ã®é¦–éƒ½ã§ã™";
      } else if (text == "ãƒ™ãƒ«ãƒªãƒ³"){
          return "ãƒ™ãƒ«ãƒªãƒ³ã¯ãƒ‰ã‚¤ãƒ„ã®é¦–éƒ½ã§ã™";
      } else if (text == "ãƒ–ãƒªãƒ¥ãƒƒã‚»ãƒ«"){
          return "ãƒ–ãƒªãƒ¥ãƒƒã‚»ãƒ«ã¯ãƒ™ãƒ«ã‚®ãƒ¼ã®é¦–éƒ½ã§ã™";
      } else if (text == "ãƒ–ã‚«ãƒ¬ã‚¹ãƒˆ"){
          return "ãƒ–ã‚«ãƒ¬ã‚¹ãƒˆã¯ãƒ«ãƒ¼ãƒãƒ‹ã‚¢ã®é¦–éƒ½ã§ã™";
      } else if (text == "ãƒ¢ã‚¹ã‚¯ãƒ¯"){
          return "ãƒ¢ã‚¹ã‚¯ãƒ¯ã¯ãƒ­ã‚·ã‚¢ã®é¦–éƒ½ã§ã™";
      } else if (text == "ã‚«ã‚¤ãƒ­"){
          return "ã‚«ã‚¤ãƒ­ã¯ã‚¨ã‚¸ãƒ—ãƒˆã®é¦–éƒ½ã§ã™";
      } else if (text == "ãƒŠã‚¤ãƒ­ãƒ“"){
          return "ãƒŠã‚¤ãƒ­ãƒ“ã¯ã‚±ãƒ‹ã‚¢ã®é¦–éƒ½ã§ã™";
      } else if (text == "ãƒ¯ã‚·ãƒ³ãƒˆãƒ³ï¼¤ï¼£"){
          return "ãƒ¯ã‚·ãƒ³ãƒˆãƒ³ï¼¤ï¼£ã¯ã‚¢ãƒ¡ãƒªã‚«ã®é¦–éƒ½ã§ã™";
      } else if (text == "ã‚ªã‚¿ãƒ¯"){
          return "ã‚ªã‚¿ãƒ¯ã¯ã‚«ãƒŠãƒ€ã®é¦–éƒ½ã§ã™";
      } else if (text == "ãƒãƒãƒŠ"){
          return "ãƒãƒãƒŠã¯ã‚­ãƒ¥ãƒ¼ãƒã®é¦–éƒ½ã§ã™";
      } else if (text == "ã‚­ãƒ³ã‚°ã‚¹ãƒˆãƒ³"){
          return "ã‚­ãƒ³ã‚°ã‚¹ãƒˆãƒ³ã¯ã‚¸ãƒ£ãƒã‚¤ã‚«ã®é¦–éƒ½ã§ã™";
      } else if (text == "ãƒ¡ã‚­ã‚·ã‚³ã‚·ãƒ†ã‚£"){
          return "ãƒ¡ã‚­ã‚·ã‚³ã‚·ãƒ†ã‚£ã¯ãƒ¡ã‚­ã‚·ã‚³ã®é¦–éƒ½ã§ã™";
      } else if (text == "ãƒ–ã‚¨ãƒã‚¹ã‚¢ã‚¤ãƒ¬ã‚¹"){
          return "ãƒ–ã‚¨ãƒã‚¹ã‚¢ã‚¤ãƒ¬ã‚¹ã¯ã‚¢ãƒ«ã‚¼ãƒ³ãƒãƒ³ã®é¦–éƒ½ã§ã™";
      } else if (text == "ãƒ–ãƒ©ã‚¸ãƒªã‚¢"){
          return "ãƒ–ãƒ©ã‚¸ãƒªã‚¢ã¯ãƒ–ãƒ©ã‚¸ãƒ«ã®é¦–éƒ½ã§ã™";
      } else if (text == "ãƒªãƒ"){
          return "ãƒªãƒã¯ãƒšãƒ«ãƒ¼ã®é¦–éƒ½ã§ã™";
      } else if (text == "ãƒ¢ãƒ³ãƒ†ãƒ“ãƒ‡ã‚ª"){
          return "ãƒ¢ãƒ³ãƒ†ãƒ“ãƒ‡ã‚ªã¯ã‚¦ãƒ«ã‚°ã‚¢ã‚¤ã®é¦–éƒ½ã§ã™";
      } else if (text == "ã‚«ãƒ©ã‚«ã‚¹"){
          return "ã‚«ãƒ©ã‚«ã‚¹ã¯ãƒ™ãƒã‚ºã‚¨ãƒ©ã®é¦–éƒ½ã§ã™";
      } else if (text == "ã‚­ãƒ£ãƒ³ãƒ™ãƒ©"){
          return "ã‚­ãƒ£ãƒ³ãƒ™ãƒ©ã¯ã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢ã®é¦–éƒ½ã§ã™";
      } else if (text == "ã‚¦ã‚§ãƒªãƒ³ãƒˆãƒ³"){
          return "ã‚¦ã‚§ãƒªãƒ³ãƒˆãƒ³ã¯ãƒ‹ãƒ¥ãƒ¼ãƒ‡ãƒªãƒ¼ã®é¦–éƒ½ã§ã™";
      } else if (text == "ãƒ›ãƒ‹ã‚¢ãƒ©"){
          return "ãƒ›ãƒ‹ã‚¢ãƒ©ã¯ã‚½ãƒ­ãƒ¢ãƒ³è«¸å³¶ã®é¦–éƒ½ã§ã™";
      } else if (text == "ã‚¹ãƒ"){
          return "ã‚¹ãƒã¯ãƒ•ã‚£ã‚¸ãƒ¼ã®é¦–éƒ½ã§ã™";
      } else {
          return "ã‚ˆãã‚ã‹ã‚Šã¾ã›ã‚“";
      }
  }
    
//    const quiz_btn = document.querySelector("#quiz_btn");
//    quiz_btn.onclick = function(){
//        const value = ["","ï¼‘å•","ï¼’å•"];
//        const num = Math.ceil(Math.random()*2);
//        
//        if(num == 1){
//            const h = document.querySelector("#view");
//            h.innerHTML = 'å…µåº«ã€å¥ˆè‰¯ã€å¤§é˜ªã®ä¸­ã§ã€ã„ã¤ã‚‚çœ ãã†ã«ã—ã¦ã„ã‚‹ã®ã¯ã©ã“ã®äººï¼Ÿ<br>â‰ªåˆ†ã‹ã‚‰ãªã‹ã£ãŸã‚‰ã€ãƒ’ãƒ³ãƒˆï¼‘ã¨è¨€ã£ã¦ã­ï¼â‰«';
//            h.style.color="red";
//        }
//        if(num == 2){
//            const h = document.querySelector("#view");
//            h.innerHTML = 'é›¨ãŒãµã£ã¦ãã‚‹ã¨ã€ãŸãã•ã‚“ã‚ã‚‰ã‚ã‚Œã‚‹é³¥ã£ã¦ãªã«ï¼Ÿ<br>â‰ªåˆ†ã‹ã‚‰ãªã‹ã£ãŸã‚‰ã€ãƒ’ãƒ³ãƒˆï¼’ã¨è¨€ã£ã¦ã­ï¼â‰«';
//            h.style.color="blue";
//        }
//    }

  // ç™ºè©±æ©Ÿèƒ½ã‚’ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–
  let msg = new SpeechSynthesisUtterance();
  let voices = window.speechSynthesis.getVoices();

  function speak(text) {
    // ä»¥ä¸‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³è¨­å®šï¼ˆæ—¥æœ¬èªã¯åŠ¹ã‹ãªã„ã‚‚ã‚ˆã†ã€‚ã€‚ï¼‰
    msg.voice = voices[7]; // 7:Google æ—¥æœ¬äºº ja-JP â€»ä»–ã¯è‹±èªã®ã¿
    msg.volume = 1.0; // éŸ³é‡ min 0 ~ max 1
    msg.rate = 1.0; // é€Ÿåº¦ min 0 ~ max 10
    msg.pitch = 1.0; // éŸ³ç¨‹ min 0 ~ max 2

    msg.text = text;// å–‹ã‚‹å†…å®¹
    msg.lang = 'ja-JP'; // en-US or ja-JP
    // msg.lang = 'en-US'; // en-US or ja-JP

    // ç™ºè©±å®Ÿè¡Œ
    speechSynthesis.speak(msg);
  }
  
  // çµ‚äº†æ™‚ã®å‡¦ç†
  msg.onend = function (event) {
    console.log('å–‹ã£ãŸæ™‚é–“ï¼š' + event.elapsedTime + 'ms');
  }


</script>


     <button id="mybtn">ï¼Šmapï¼Š</button>
      <br>
      <table>
      <tr>
          <th>Erea</th>
          <th>Capital city</th>
          <th>Map</th>
    </tr>
      </table>
       <div id="contents">
       </div>
<script>
    /* global $ loadSheets */
    $(function(){
      $("#mybtn").on("click",showdata);

        
      async function showdata () {
          let data = await loadSheets('s1314149_2!A1:D100');
          console.log(data.values[0][0]);
          $("#contents").append(data.values[1][1]);
          $("#contents").append(data.values[1][2]);
          $("#contents").append(data.values[1][3]);
          $("#contents").append("<br>");
          
          $("#contents").append(data.values[2][1]);
          $("#contents").append(data.values[2][2]);
          $("#contents").append(data.values[2][3]);
          $("#contents").append("<br>");
        
          $("#contents").append(data.values[3][1]);
          $("#contents").append(data.values[3][2]);
          $("#contents").append(data.values[3][3]);
          $("#contents").append("<br>");
          
          $("#contents").append(data.values[4][1]);
          $("#contents").append(data.values[4][2]);
          $("#contents").append(data.values[4][3]);
          $("#contents").append("<br>");
          
          $("#contents").append(data.values[5][1]);
          $("#contents").append(data.values[5][2]);
          $("#contents").append(data.values[5][3]);
          $("#contents").append("<br>");
          
          $("#contents").append(data.values[6][1]);
          $("#contents").append(data.values[6][2]);
          $("#contents").append(data.values[6][3]);
          $("#contents").append("<br>");
          
          $("#contents").append(data.values[7][1]);
          $("#contents").append(data.values[7][2]);
          $("#contents").append(data.values[7][3]);
          $("#contents").append("<br>");
          
          $("#contents").append(data.values[8][1]);
          $("#contents").append(data.values[8][2]);
          $("#contents").append(data.values[8][3]);
          $("#contents").append("<br>");
          
          $("#contents").append(data.values[9][1]);
          $("#contents").append(data.values[9][2]);
          $("#contents").append(data.values[9][3]);
          $("#contents").append("<br>");
          
          $("#contents").append(data.values[10][1]);
          $("#contents").append(data.values[10][2]);
          $("#contents").append(data.values[10][3]);
          $("#contents").append("<br>");
          
          $("#contents").append(data.values[11][1]);
          $("#contents").append(data.values[11][2]);
          $("#contents").append(data.values[11][3]);
          $("#contents").append("<br>");
          
          $("#contents").append(data.values[12][1]);
          $("#contents").append(data.values[12][2]);
          $("#contents").append(data.values[12][3]);
          $("#contents").append("<br>");
          
          $("#contents").append(data.values[13][1]);
          $("#contents").append(data.values[13][2]);
          $("#contents").append(data.values[13][3]);
          $("#contents").append("<br>");
          
          $("#contents").append(data.values[14][1]);
          $("#contents").append(data.values[14][2]);
          $("#contents").append(data.values[14][3]);
          $("#contents").append("<br>");
          
          $("#contents").append(data.values[15][1]);
          $("#contents").append(data.values[15][2]);
          $("#contents").append(data.values[15][3]);
          $("#contents").append("<br>");
          
          $("#contents").append(data.values[16][1]);
          $("#contents").append(data.values[16][2]);
          $("#contents").append(data.values[16][3]);
          $("#contents").append("<br>");
          
          $("#contents").append(data.values[17][1]);
          $("#contents").append(data.values[17][2]);
          $("#contents").append(data.values[17][3]);
          $("#contents").append("<br>");
          
          $("#contents").append(data.values[18][1]);
          $("#contents").append(data.values[18][2]);
          $("#contents").append(data.values[18][3]);
          $("#contents").append("<br>");
          
          $("#contents").append(data.values[19][1]);
          $("#contents").append(data.values[19][2]);
          $("#contents").append(data.values[19][3]);
          $("#contents").append("<br>");
          
          $("#contents").append(data.values[20][1]);
          $("#contents").append(data.values[20][2]);
          $("#contents").append(data.values[20][3]);
          $("#contents").append("<br>");
          
          $("#contents").append(data.values[21][1]);
          $("#contents").append(data.values[21][2]);
          $("#contents").append(data.values[21][3]);
          $("#contents").append("<br>");
      }
    });

    </script>
    <script async defer src="https://apis.google.com/js/api.js"
      onload="this.onload=function(){};handleClientLoad()"
      onreadystatechange="if (this.readyState === 'complete') this.onload()">
    </script>
</body>
</html>